<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Primitive Identification Tagging &amp; Tracking (PITT). The  &quot;Object Table Segmentation&quot; package: supportsSegmentationServer.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Primitive Identification Tagging &amp; Tracking (PITT). The  &quot;Object Table Segmentation&quot; package
   &#160;<span id="projectnumber">v1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('supportsSegmentationServer_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">supportsSegmentationServer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="supportsSegmentationServer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;ros/ros.h&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;math.h&quot;</span>                               <span class="comment">// for spqr function</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;pcl_ros/point_cloud.h&gt;</span>                <span class="comment">// pcl to ros conversion library</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;std_msgs/String.h&gt;</span>                    <span class="comment">// for point clod 2 ros msg</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;pcl/segmentation/sac_segmentation.h&gt;</span>  <span class="comment">// for pcl segmentation object</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;pcl/filters/extract_indices.h&gt;</span>        <span class="comment">// for pcl extract a sub cloud from cloud</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// services and messages</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;pitt_msgs/SupportSegmentation.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;pitt_msgs/InliersSupport.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// custom class</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;../PCStaticProcessing/PCManager.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// used name space</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//using namespace pitt_object_table_segmentation;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">using namespace </span>pitt_msgs;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">using namespace </span>ros;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">using namespace </span>pcm;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">using namespace </span>pcl;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">using namespace </span>boost;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// used abbrevations (given from PCManager in turn given from PCPrimitive)</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//typedef pcl::PointCloud&lt; pcl::PointXYZ&gt; PCLCloud;                     // for point cloud</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//typedef pcl::PointCloud&lt; pcl::PointXYZ&gt;::Ptr PCLCloudPtr;             // for point cloud smart pointer</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//typedef pcl::PointCloud&lt; pcl::Normal&gt; PCLNormal;                      // for normal estimation of a point cloud</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//typedef pcl::PointCloud&lt; pcl::Normal&gt;::Ptr PCLNormalPtr;              // for normal estimation of a point cloud smart pointer</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// constant parameters</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#af8b66843d91c073a7339d97da05e4cfa">   33</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="supportsSegmentationServer_8cpp.html#af8b66843d91c073a7339d97da05e4cfa">MIN_ITERATIVE_CLOUD_PERCENTUAL_SIZE</a> = 0.030f;<span class="comment">// percentage of number of points (must be [0,1])</span></div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a1cb5f58d4341fb0ea8be5786e76e850c">   34</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a1cb5f58d4341fb0ea8be5786e76e850c">MIN_PLANE_PERCENTAGE_SIZE</a> = 0.030f; <span class="comment">// percentage of number of points (must be [0,1])</span></div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a31976c93f57ecffe05dcdb46e5a1eb4a">   35</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a31976c93f57ecffe05dcdb46e5a1eb4a">MAX_VARIANCE_TH_FOR_HORIZONTAL</a> = 0.09f;  <span class="comment">// the variance must be small to discriminate horizontal planes</span></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#acc65cc4496947189ecf64074b20c9a6b">   36</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="supportsSegmentationServer_8cpp.html#acc65cc4496947189ecf64074b20c9a6b">RANSAC_MAX_ITERATION_TH</a> = 10; <span class="comment">// max number of iterations fro ransac plane segmentation</span></div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#ab8a45d894e93cb97afbd56586a97172d">   37</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="supportsSegmentationServer_8cpp.html#ab8a45d894e93cb97afbd56586a97172d">RANSAC_TH_DISTANCE_POINT_SHAPE</a> = 0.02f;<span class="comment">//0.02f; // meters (distance between point to belong to the same shape)</span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a9dc99e81f4ba41b83214b0d6b629dd10">   38</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a9dc99e81f4ba41b83214b0d6b629dd10">RANSAC_NORMAL_DISTANCE_WEIGHT</a> = 0.9f; <span class="comment">// must belong to [0,1]</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a7e5e89000afcc1ee5b2f3aca14c819d8">   39</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a7e5e89000afcc1ee5b2f3aca14c819d8">HORIZONTAL_AXIS</a>[ 3] = { 0.0f, 0.0f, -1.0f}; <span class="comment">// normal coordinate of the graund plane // to be an input parameter serveice !!!!!!!!!!!</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a7ea400b8bac873942021139dabfda6be">   40</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a7ea400b8bac873942021139dabfda6be">SUPPORT_EDG_REMOVEE_OFSET</a> = 0.02; <span class="comment">// distance in meters between the edge of the table and the possible points on in (remove point on table edge) to avoid to consider the wall attached to the table as an object on it</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// initilize static parameter with default or incoming value (default if value are &lt; 0 or array has size != 3)</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a99daf6bf3b99a58055b66c72a8040bef">   43</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="supportsSegmentationServer_8cpp.html#aad09e65ed4fbd692157ce317f949c892">minIterativeCloudPercentage</a>, <a class="code" href="supportsSegmentationServer_8cpp.html#a4347491f1f8b99276368828ab1133658">minPlanePercentageSize</a>, <a class="code" href="supportsSegmentationServer_8cpp.html#a197bb458bd6fcbde04f684821eec83fb">minVarianceThForHorizontal</a>, <a class="code" href="supportsSegmentationServer_8cpp.html#af902851fe5d5f9b83a6fd3caa09ff6e6">maxVarianceThForHorizontal</a>, <a class="code" href="supportsSegmentationServer_8cpp.html#acb13e2ccfe978df3c0ae59f3209561e7">ransacThDistancePointShape</a>, <a class="code" href="supportsSegmentationServer_8cpp.html#ad870cd7d7c56cf82343d1a2a59072627">ransacNormalDistanceWeigth</a>, <a class="code" href="supportsSegmentationServer_8cpp.html#a99daf6bf3b99a58055b66c72a8040bef">supportEdgeRemoveOffset</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">   44</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a>[ 3];</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#adf23ae5b5b90ea992496e126ae78a3a5">   45</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="supportsSegmentationServer_8cpp.html#adf23ae5b5b90ea992496e126ae78a3a5">ransacMaxIteration</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a53687def603ff613a673c0dd550acf4e">   46</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a53687def603ff613a673c0dd550acf4e">initializeParameters</a>( SupportSegmentation::Request  &amp;req){</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span>( req.minIterativeCloudPercentualSize &gt;= 0.0f)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#aad09e65ed4fbd692157ce317f949c892">minIterativeCloudPercentage</a> = req.minIterativeCloudPercentualSize;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="supportsSegmentationServer_8cpp.html#aad09e65ed4fbd692157ce317f949c892">minIterativeCloudPercentage</a> = <a class="code" href="supportsSegmentationServer_8cpp.html#af8b66843d91c073a7339d97da05e4cfa">MIN_ITERATIVE_CLOUD_PERCENTUAL_SIZE</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">if</span>( req.minPlanePercentualSize &gt;= 0.0f)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#a4347491f1f8b99276368828ab1133658">minPlanePercentageSize</a> = req.minPlanePercentualSize;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a4347491f1f8b99276368828ab1133658">minPlanePercentageSize</a> = <a class="code" href="supportsSegmentationServer_8cpp.html#a1cb5f58d4341fb0ea8be5786e76e850c">MIN_PLANE_PERCENTAGE_SIZE</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span>( req.maxVarianceThForHorizontal &gt;= 0.0f)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#af902851fe5d5f9b83a6fd3caa09ff6e6">maxVarianceThForHorizontal</a> = req.maxVarianceThForHorizontal;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#af902851fe5d5f9b83a6fd3caa09ff6e6">maxVarianceThForHorizontal</a> = <a class="code" href="supportsSegmentationServer_8cpp.html#a31976c93f57ecffe05dcdb46e5a1eb4a">MAX_VARIANCE_TH_FOR_HORIZONTAL</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#a197bb458bd6fcbde04f684821eec83fb">minVarianceThForHorizontal</a> = -1 * <a class="code" href="supportsSegmentationServer_8cpp.html#af902851fe5d5f9b83a6fd3caa09ff6e6">maxVarianceThForHorizontal</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">if</span>( req.ransacThDistancePointShape &gt;= 0.0f)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#acb13e2ccfe978df3c0ae59f3209561e7">ransacThDistancePointShape</a> = req.ransacThDistancePointShape;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="supportsSegmentationServer_8cpp.html#acb13e2ccfe978df3c0ae59f3209561e7">ransacThDistancePointShape</a> = <a class="code" href="supportsSegmentationServer_8cpp.html#ab8a45d894e93cb97afbd56586a97172d">RANSAC_TH_DISTANCE_POINT_SHAPE</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span>( req.ransacModelDistanceWeigth &gt;= 0.0f)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#ad870cd7d7c56cf82343d1a2a59072627">ransacNormalDistanceWeigth</a> = req.ransacModelDistanceWeigth;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="supportsSegmentationServer_8cpp.html#ad870cd7d7c56cf82343d1a2a59072627">ransacNormalDistanceWeigth</a> = <a class="code" href="supportsSegmentationServer_8cpp.html#a9dc99e81f4ba41b83214b0d6b629dd10">RANSAC_NORMAL_DISTANCE_WEIGHT</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span>( req.ransaxMaxIterationTh &gt;= 0)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#adf23ae5b5b90ea992496e126ae78a3a5">ransacMaxIteration</a> = req.ransacModelDistanceWeigth;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="supportsSegmentationServer_8cpp.html#adf23ae5b5b90ea992496e126ae78a3a5">ransacMaxIteration</a> = <a class="code" href="supportsSegmentationServer_8cpp.html#acc65cc4496947189ecf64074b20c9a6b">RANSAC_MAX_ITERATION_TH</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span>( req.horizontalAxis.size() == 3){</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a>[ 0] = req.horizontalAxis[ 0];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a>[ 1] = req.horizontalAxis[ 1];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a>[ 2] = req.horizontalAxis[ 2];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a>[ 0] = <a class="code" href="supportsSegmentationServer_8cpp.html#a7e5e89000afcc1ee5b2f3aca14c819d8">HORIZONTAL_AXIS</a>[ 0];</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a>[ 1] = <a class="code" href="supportsSegmentationServer_8cpp.html#a7e5e89000afcc1ee5b2f3aca14c819d8">HORIZONTAL_AXIS</a>[ 1];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a>[ 2] = <a class="code" href="supportsSegmentationServer_8cpp.html#a7e5e89000afcc1ee5b2f3aca14c819d8">HORIZONTAL_AXIS</a>[ 2];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span>( req.supportEdgeRemoveOffset &gt;= 0){</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#a99daf6bf3b99a58055b66c72a8040bef">supportEdgeRemoveOffset</a> = req.supportEdgeRemoveOffset;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    } <span class="keywordflow">else</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a99daf6bf3b99a58055b66c72a8040bef">supportEdgeRemoveOffset</a> = <a class="code" href="supportsSegmentationServer_8cpp.html#a7ea400b8bac873942021139dabfda6be">SUPPORT_EDG_REMOVEE_OFSET</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">// common global variables</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#abb8f65165b6cd9a52d46c3f8dab2872f">   83</a></span>&#160;<a class="code" href="PCManager_8h.html#a38c805dbc7ad6f06109b85c8e540817a">PCLVisualizer</a> <a class="code" href="supportsSegmentationServer_8cpp.html#abb8f65165b6cd9a52d46c3f8dab2872f">vis</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">   84</a></span>&#160;<a class="code" href="PCPrimitive_8h.html#aa14a240c8d999c4f56133c0f70e88783">PCLCloudPtr</a> <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a2974d140b39b60770786decb2d3565b1">   85</a></span>&#160;<a class="code" href="PCPrimitive_8h.html#a1bc38ce8b0c26e5f2d28fae9f3e3ea97">PCLNormalPtr</a> <a class="code" href="supportsSegmentationServer_8cpp.html#a2974d140b39b60770786decb2d3565b1">originalNorms</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// visualize inlier idx w.r.t to original map for debugging</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/*void visualizeInlier( PrimitiveIdxPtr indices){</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">    vector&lt; PCLCloudPtr&gt; idxCloud = PCManager::getCloudFromIdx( originalCloud, indices);</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">    for( int i = 0; i &lt; idxCloud.size(); i++)</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">        PCManager::updateVisor( vis, idxCloud[ i], &quot;idxMap_&quot; + ::to_string( i));</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">}*/</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// use ransac pcl implementation to find the biggest horizontal plane on the scene</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">   94</a></span>&#160;SACSegmentationFromNormals&lt; PointXYZ, Normal&gt; <a class="code" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a93fe6461918fe6c40665c81167c39f43">   95</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a93fe6461918fe6c40665c81167c39f43">ransacPlaneSegmentator</a>( <a class="code" href="PCPrimitive_8h.html#aa14a240c8d999c4f56133c0f70e88783">PCLCloudPtr</a> inputCloud, <a class="code" href="PCPrimitive_8h.html#a1bc38ce8b0c26e5f2d28fae9f3e3ea97">PCLNormalPtr</a> normals, PointIndices::Ptr &amp;inlierOutput, ModelCoefficients::Ptr &amp;coefficientOutput){</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// Create the segmentation object for the PLANAR model and set all the parameters</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a>.setOptimizeCoefficients( <span class="keyword">true</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a>.setModelType( pcl::SACMODEL_PLANE);<span class="comment">//::SACMODEL_PARALLEL_PLANE);</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// axes in which compute parallelism or horizontality</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">//seg.setAxis( Eigen::Vector3f(0,0,1)); // PARALLEL to z-axis (of the camera)</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// threshold of error between axis (for parallelism or horizontality)</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">//seg.setEpsAngle( 0.008); // error in radiants w.r.t. perfect parallelism</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a>.setMethodType( pcl::SAC_RANSAC);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// the relative weight (between 0 and 1) to give to the angular distance (0 to pi/2) between</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// point normals and the plane normal. (The Euclidean distance will have weight 1-w.)</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a>.setNormalDistanceWeight( <a class="code" href="supportsSegmentationServer_8cpp.html#ad870cd7d7c56cf82343d1a2a59072627">ransacNormalDistanceWeigth</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a>.setMaxIterations( <a class="code" href="supportsSegmentationServer_8cpp.html#adf23ae5b5b90ea992496e126ae78a3a5">ransacMaxIteration</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// max distance between point to the same primitive</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// if smaller =&gt; more separate points as shapes</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// if bigger =&gt; more surphase as a shape</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a>.setDistanceThreshold( <a class="code" href="supportsSegmentationServer_8cpp.html#acb13e2ccfe978df3c0ae59f3209561e7">ransacThDistancePointShape</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a>.setInputCloud( inputCloud);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a>.setInputNormals( normals);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// Obtain the plane inliers and coefficients</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a>.segment (*inlierOutput, *coefficientOutput);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">// remove points for a cloud and compute the new cloud without such point</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;ExtractIndices&lt; PointXYZ&gt; <a class="code" href="supportsSegmentationServer_8cpp.html#ad788fb6fb1f61d45a10993e909fddad8">extract</a> ( <span class="keyword">true</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#aec3cb01834351aa77d85fb42364ff543">  120</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="supportsSegmentationServer_8cpp.html#aec3cb01834351aa77d85fb42364ff543">removePlaneInliner</a>( <a class="code" href="PCPrimitive_8h.html#aa14a240c8d999c4f56133c0f70e88783">PCLCloudPtr</a> inputCloud, PointIndices::Ptr &amp;removeIndex, <a class="code" href="PCPrimitive_8h.html#aa14a240c8d999c4f56133c0f70e88783">PCLCloudPtr</a> output){</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// compute output: part of the cloud with only index</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ad788fb6fb1f61d45a10993e909fddad8">extract</a>.setInputCloud( inputCloud);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ad788fb6fb1f61d45a10993e909fddad8">extract</a>.setIndices( removeIndex);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ad788fb6fb1f61d45a10993e909fddad8">extract</a>.setNegative( <span class="keyword">false</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ad788fb6fb1f61d45a10993e909fddad8">extract</a>.filter( *output);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// modify input cloud removing the index</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ad788fb6fb1f61d45a10993e909fddad8">extract</a>.setInputCloud( inputCloud);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ad788fb6fb1f61d45a10993e909fddad8">extract</a>.setIndices( removeIndex);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ad788fb6fb1f61d45a10993e909fddad8">extract</a>.setNegative( <span class="keyword">true</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ad788fb6fb1f61d45a10993e909fddad8">extract</a>.filter( *inputCloud);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">// returns true if the array contains the given value, flase otherwise ( used for populateIdxMap() )</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#af7452b4e42ac3352d3b9ff7c19dff6ea">  136</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="supportsSegmentationServer_8cpp.html#af7452b4e42ac3352d3b9ff7c19dff6ea">valueBelongsToArray</a>( <span class="keywordtype">int</span> value, PointIndices::Ptr inliers){</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; inliers-&gt;indices.size() ; i++)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">if</span>( value == inliers-&gt;indices[i])</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">// given the previous inlier map it create the new inlier idx map</span></div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a32c40c5b97dadeee297fd5e4f8d36513">  144</a></span>&#160;<a class="code" href="PCPrimitive_8h.html#a6ec0f6fbb026ae4b66cac121673c3a8a">PrimitiveIdxPtr</a> <a class="code" href="supportsSegmentationServer_8cpp.html#a32c40c5b97dadeee297fd5e4f8d36513">createNewIdxMap</a>( <a class="code" href="PCPrimitive_8h.html#a6ec0f6fbb026ae4b66cac121673c3a8a">PrimitiveIdxPtr</a> previousInliersMap, PointIndices::Ptr inliers, <span class="keywordtype">int</span> level){</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">int</span> cnt = 0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">int</span> nPoint = previousInliersMap-&gt;size();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="PCPrimitive_8h.html#a6ec0f6fbb026ae4b66cac121673c3a8a">PrimitiveIdxPtr</a> newInliersMap( <span class="keyword">new</span> <a class="code" href="PCPrimitive_8h.html#a9aba110b238bb80390c2545da40823e3">PrimitiveIdx</a>( nPoint));</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> p = 0; p &lt; nPoint; p++){</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span>( (* previousInliersMap)[ p] &gt; level &amp;&amp; (* previousInliersMap)[ p] &lt; 0){</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="comment">// propagate the data since this sub cloud does not belongs to the new points</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            ( * newInliersMap)[ p] = (* previousInliersMap)[ p];</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="supportsSegmentationServer_8cpp.html#af7452b4e42ac3352d3b9ff7c19dff6ea">valueBelongsToArray</a>( (* previousInliersMap)[ p], inliers)){</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="comment">// add level tag to sign this point to belong to the new cloud</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            ( * newInliersMap)[ p] = level; <span class="comment">// negative numbers</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="comment">// keep counting since the point does not belong to any shapes</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            ( * newInliersMap)[ p] = cnt++;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">return</span>( newInliersMap);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">// returns true if the plane is horizontal, false otherwise</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">// a plane is horizontal to another if the cross product w.r.t. the normals tends to zero</span></div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#ab0fa44eb10c2965d2e3a67a7f386c747">  166</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="supportsSegmentationServer_8cpp.html#ab0fa44eb10c2965d2e3a67a7f386c747">isHorizontalPlane</a>( <a class="code" href="PCPrimitive_8h.html#a1bc38ce8b0c26e5f2d28fae9f3e3ea97">PCLNormalPtr</a> normal, ModelCoefficients::Ptr coefficients, <span class="keyword">const</span> <span class="keywordtype">float</span> referimentAxis[ 3]){ <span class="comment">// vect&lt;3&gt;(X,Y,Z) for the reference normal to the plane</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// compute normal from cooeficient    nx = a / sqrt( a^2 + b^2 + c^2)  ny = b / sqrt( a^2 + b^2 + c^2)    nz = c / sqrt( a^2 + b^2 + c^2)</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">float</span> div = sqrtf( coefficients-&gt;values[ 0] * coefficients-&gt;values[ 0] + coefficients-&gt;values[ 1] * coefficients-&gt;values[ 1] + coefficients-&gt;values[ 2] * coefficients-&gt;values[ 2] );</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">float</span> normX = coefficients-&gt;values[ 0] / div;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">float</span> normY = coefficients-&gt;values[ 1] / div;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">float</span> normZ = coefficients-&gt;values[ 2] / div;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// compute cross product to see if the plane is parallel to the given axes</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">float</span> crossX = normY * referimentAxis[ 2] - normZ * referimentAxis[ 1];</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">float</span> crossY = normZ * referimentAxis[ 0] - normX * referimentAxis[ 2];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">float</span> crossZ = normX * referimentAxis[ 1] - normY * referimentAxis[ 0];</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// check id the cross product -&gt; 0</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span>(     (( crossX &gt; <a class="code" href="supportsSegmentationServer_8cpp.html#a197bb458bd6fcbde04f684821eec83fb">minVarianceThForHorizontal</a>) &amp;&amp; ( crossX &lt; <a class="code" href="supportsSegmentationServer_8cpp.html#af902851fe5d5f9b83a6fd3caa09ff6e6">maxVarianceThForHorizontal</a>)) &amp;&amp;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            (( crossY &gt; <a class="code" href="supportsSegmentationServer_8cpp.html#a197bb458bd6fcbde04f684821eec83fb">minVarianceThForHorizontal</a>) &amp;&amp; ( crossY &lt; <a class="code" href="supportsSegmentationServer_8cpp.html#af902851fe5d5f9b83a6fd3caa09ff6e6">maxVarianceThForHorizontal</a>)) &amp;&amp;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            (( crossZ &gt; <a class="code" href="supportsSegmentationServer_8cpp.html#a197bb458bd6fcbde04f684821eec83fb">minVarianceThForHorizontal</a>) &amp;&amp; ( crossZ &lt; <a class="code" href="supportsSegmentationServer_8cpp.html#af902851fe5d5f9b83a6fd3caa09ff6e6">maxVarianceThForHorizontal</a>))    )</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">// return all the points that, if projected will follow in the given plane</span></div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a036699b594fc2e37ecd35243a0a7e2bb">  187</a></span>&#160;<span class="preprocessor">#define LESS_INF    -9999999.0</span></div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a12c2040f25d8e3a7b9e1c2024c618cb6">  188</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define INF         9999999.0</span></div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a7788e49ce18c43d68c6e9b31f7c8c1eb">  189</a></span>&#160;<span class="preprocessor"></span><a class="code" href="PCPrimitive_8h.html#aa14a240c8d999c4f56133c0f70e88783">PCLCloudPtr</a> <a class="code" href="supportsSegmentationServer_8cpp.html#a7788e49ce18c43d68c6e9b31f7c8c1eb">getPointOnPlane</a>( <a class="code" href="PCPrimitive_8h.html#aa14a240c8d999c4f56133c0f70e88783">PCLCloudPtr</a> plane, <a class="code" href="PCPrimitive_8h.html#a6ec0f6fbb026ae4b66cac121673c3a8a">PrimitiveIdxPtr</a> inlierIdx, <span class="keywordtype">int</span> mapLevel){</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// get the margin of the plane</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">float</span> xMax = <a class="code" href="supportsSegmentationServer_8cpp.html#a036699b594fc2e37ecd35243a0a7e2bb">LESS_INF</a>, yMax = <a class="code" href="supportsSegmentationServer_8cpp.html#a036699b594fc2e37ecd35243a0a7e2bb">LESS_INF</a>, zMed = 0;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">float</span> xMin = <a class="code" href="supportsSegmentationServer_8cpp.html#a12c2040f25d8e3a7b9e1c2024c618cb6">INF</a>, yMin = <a class="code" href="supportsSegmentationServer_8cpp.html#a12c2040f25d8e3a7b9e1c2024c618cb6">INF</a>;<span class="comment">//, zMin = INF;</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; plane-&gt;size(); i++){</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span>( plane-&gt;points[ i].x &gt; xMax)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            xMax = plane-&gt;points[ i].x;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( plane-&gt;points[ i].x &lt; xMin)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            xMin = plane-&gt;points[ i].x;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span>( plane-&gt;points[ i].y &gt; yMax)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            yMax = plane-&gt;points[ i].y;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( plane-&gt;points[ i].y &lt; yMin)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            yMin = plane-&gt;points[ i].y;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">// min or max are wrong pheraps it is possible to do it with the mean</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment">//if( plane-&gt;points[ i].z &gt; zMax)</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">//  zMax = plane-&gt;points[ i].z;</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="comment">//else if ( plane-&gt;points[ i].z &lt; zMin)</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="comment">//  zMin = plane-&gt;points[ i].z;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        zMed += plane-&gt;points[ i].z;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// remove some space on the edge of the plane (to do not consider object (e.g. wall) attached to table edge as their are placed on it)</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    xMax -= <a class="code" href="supportsSegmentationServer_8cpp.html#a99daf6bf3b99a58055b66c72a8040bef">supportEdgeRemoveOffset</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    xMin += <a class="code" href="supportsSegmentationServer_8cpp.html#a99daf6bf3b99a58055b66c72a8040bef">supportEdgeRemoveOffset</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    yMax -= <a class="code" href="supportsSegmentationServer_8cpp.html#a99daf6bf3b99a58055b66c72a8040bef">supportEdgeRemoveOffset</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    yMin += <a class="code" href="supportsSegmentationServer_8cpp.html#a99daf6bf3b99a58055b66c72a8040bef">supportEdgeRemoveOffset</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">//zMax -= supportEdgeRemoveOffset;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">//zMin += supportEdgeRemoveOffset;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    zMed = zMed / plane-&gt;size() + 0.005;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="PCPrimitive_8h.html#aa14a240c8d999c4f56133c0f70e88783">PCLCloudPtr</a> out ( <span class="keyword">new</span> <a class="code" href="PCPrimitive_8h.html#a02a7c0cdfcd324f1b5b87ce549fdbe10">PCLCloud</a>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// remove known plane</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    PointIndices::Ptr removingIdx( <span class="keyword">new</span> PointIndices);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; inlierIdx-&gt;size(); i++)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">if</span>( (* inlierIdx)[ i] == mapLevel)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            removingIdx-&gt;indices.push_back( i);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// found the points that are on top of the table</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;size(); i++){</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">if</span>( ! <a class="code" href="supportsSegmentationServer_8cpp.html#af7452b4e42ac3352d3b9ff7c19dff6ea">valueBelongsToArray</a>( i, removingIdx))</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;points[ i].x &gt; xMin &amp;&amp; <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;points[ i].x &lt; xMax &amp;&amp;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                    <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;points[ i].z &gt; zMed &amp;&amp;<span class="comment">// originalCloud-&gt;points[ i].z &lt; zMax &amp;&amp;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;points[ i].y &gt; yMin &amp;&amp; <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;points[ i].y &lt; yMax)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                out-&gt;push_back( <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;points[ i]);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">// find horizontal plane iteratively with respect to original cloud</span></div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a5516ae3363218ea9eafda7f65e6d2a49">  243</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a5516ae3363218ea9eafda7f65e6d2a49">findSupports</a>( SupportSegmentation::Request&amp; req, SupportSegmentation::Response&amp; res){</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#a53687def603ff613a673c0dd550acf4e">initializeParameters</a>( req);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// get service inputs</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a> = PCManager::cloudForRosMsg( req.originalCloud);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="supportsSegmentationServer_8cpp.html#a2974d140b39b60770786decb2d3565b1">originalNorms</a> = PCManager::normForRosMsg( req.originalNorms);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// useful variable for iterative horizontal palne segmentation trhougth ransac</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="PCPrimitive_8h.html#aa14a240c8d999c4f56133c0f70e88783">PCLCloudPtr</a> iterativeCloud( <span class="keyword">new</span> <a class="code" href="PCPrimitive_8h.html#a02a7c0cdfcd324f1b5b87ce549fdbe10">PCLCloud</a>( *<a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="PCPrimitive_8h.html#a1bc38ce8b0c26e5f2d28fae9f3e3ea97">PCLNormalPtr</a> iterativeNorm( <span class="keyword">new</span> <a class="code" href="PCPrimitive_8h.html#abe81b5e6ffcc0ceb1b95b0489419027d">PCLNormal</a>( *<a class="code" href="supportsSegmentationServer_8cpp.html#a2974d140b39b60770786decb2d3565b1">originalNorms</a>));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    PointIndicesPtr inliersPlane( <span class="keyword">new</span> PointIndices);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    ModelCoefficients::Ptr coefficientsPlane( <span class="keyword">new</span> ModelCoefficients);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// create begining inlier (original cloud index)</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="PCPrimitive_8h.html#a9aba110b238bb80390c2545da40823e3">PrimitiveIdx</a> originalInlierIdx ( <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;size());</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; originalInlierIdx.size(); i++)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        originalInlierIdx[ i] = i;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// iteratively look for supporting planes</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">bool</span> loop = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">int</span> idxMapLayer = -2; <span class="comment">// -1 is for all the non horizontal planes points</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">int</span> cnt = 0;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="PCPrimitive_8h.html#a6ec0f6fbb026ae4b66cac121673c3a8a">PrimitiveIdxPtr</a> newInliersIdx;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">while</span>( loop){</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">// look for horizontal plane</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="supportsSegmentationServer_8cpp.html#a93fe6461918fe6c40665c81167c39f43">ransacPlaneSegmentator</a>( iterativeCloud, iterativeNorm, inliersPlane, coefficientsPlane);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// stop looping if no plane are found even if the remaining cloud has more points than the threshould</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">if</span>( inliersPlane-&gt;indices.empty ()){</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            loop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="comment">//cerr &lt;&lt; &quot;[EXIT] no more plane found&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iterativeCloud-&gt;points.size() &lt; <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;points.size() * <a class="code" href="supportsSegmentationServer_8cpp.html#aad09e65ed4fbd692157ce317f949c892">minIterativeCloudPercentage</a>){</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            loop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="comment">//cerr &lt;&lt; &quot;[EXIT] too few point to control are remaining&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( inliersPlane-&gt;indices.size() &lt; <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;points.size() * <a class="code" href="supportsSegmentationServer_8cpp.html#a4347491f1f8b99276368828ab1133658">minPlanePercentageSize</a>){</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            loop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="comment">//cerr &lt;&lt; &quot;[EXIT] too small plane found&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">// compute the new inlier idx w.r.t original cloud</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <a class="code" href="PCPrimitive_8h.html#a6ec0f6fbb026ae4b66cac121673c3a8a">PrimitiveIdxPtr</a> inliersIdx ( <span class="keyword">new</span> <a class="code" href="PCPrimitive_8h.html#a9aba110b238bb80390c2545da40823e3">PrimitiveIdx</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keywordflow">if</span>( ! cnt)  <span class="comment">// if it is 0 use a vector with incremental integer number as starting idx (0,1,2,3,4,....)</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i&lt; <a class="code" href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a>-&gt;size(); i++)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    inliersIdx-&gt;push_back( i);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">else</span>        <span class="comment">// else use the previous idx in the map</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                inliersIdx = newInliersIdx;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="comment">// to make the cloud smaller and look for smaller planes</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <a class="code" href="PCPrimitive_8h.html#aa14a240c8d999c4f56133c0f70e88783">PCLCloudPtr</a> supportCloud ( <span class="keyword">new</span> <a class="code" href="PCPrimitive_8h.html#a02a7c0cdfcd324f1b5b87ce549fdbe10">PCLCloud</a>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="comment">// remove inlier for cloud</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <a class="code" href="supportsSegmentationServer_8cpp.html#aec3cb01834351aa77d85fb42364ff543">removePlaneInliner</a>( iterativeCloud, inliersPlane, supportCloud);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="comment">// recompute normals</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            iterativeNorm = PCManager::estimateNormal( iterativeCloud);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="comment">// check if the found plane is horizontal</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="supportsSegmentationServer_8cpp.html#ab0fa44eb10c2965d2e3a67a7f386c747">isHorizontalPlane</a>( PCManager::estimateNormal( supportCloud), coefficientsPlane, <a class="code" href="supportsSegmentationServer_8cpp.html#a7e5e89000afcc1ee5b2f3aca14c819d8">HORIZONTAL_AXIS</a>)){ <span class="comment">// is horizontal</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="comment">// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! \\</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">                // check if point have relative distance above a threshould and eliminate them      \\</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">                // avoid that a plain contains point of separate object just because a part of the  \\</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">                // object belongs to the projection of the plane                                    \\</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">                // !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! \\</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="comment">// create new structure to be added in the output vector</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                InliersSupport::Ptr supportObj( <span class="keyword">new</span> InliersSupport);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="comment">// set the new inlier idx w.r.t original cloud into the support output data</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                newInliersIdx = <a class="code" href="supportsSegmentationServer_8cpp.html#a32c40c5b97dadeee297fd5e4f8d36513">createNewIdxMap</a>( inliersIdx, inliersPlane, idxMapLayer);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                supportObj-&gt;inliers = *newInliersIdx;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="comment">// set the cloud of the support (table)</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                supportObj-&gt;planeCloud = PCManager::cloudToRosMsg( supportCloud);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                <span class="comment">// set the cloud of the object on the table</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                supportObj-&gt;pointOnPlaneCloud = PCManager::cloudToRosMsg( <a class="code" href="supportsSegmentationServer_8cpp.html#a7788e49ce18c43d68c6e9b31f7c8c1eb">getPointOnPlane</a>( supportCloud, newInliersIdx, idxMapLayer));</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <span class="comment">// set coefficients  ( ax + by + cz + d = 0 )</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                supportObj-&gt;coeff_a = coefficientsPlane-&gt;values[ 0];</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                supportObj-&gt;coeff_b = coefficientsPlane-&gt;values[ 1];</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                supportObj-&gt;coeff_c = coefficientsPlane-&gt;values[ 2];</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                supportObj-&gt;coeff_d = coefficientsPlane-&gt;values[ 3];</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="comment">// add object to the service output vector</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                res.supportObject.push_back( *supportObj);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            } <span class="keywordflow">else</span> newInliersIdx = <a class="code" href="supportsSegmentationServer_8cpp.html#a32c40c5b97dadeee297fd5e4f8d36513">createNewIdxMap</a>( inliersIdx, inliersPlane, -1);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            cnt++;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            idxMapLayer--;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// visualize idx w.r.t. original cloud for debug</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">//if( res.supportObject.size() &gt; 0)</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">//  visualizeInlier( res.supportObject[ res.supportObject.size() - 1].inliers);</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// set used parameters</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    res.usedMinIterativeCloudPercentualSize = <a class="code" href="supportsSegmentationServer_8cpp.html#aad09e65ed4fbd692157ce317f949c892">minIterativeCloudPercentage</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    res.usedMinPlanePercentualSize = <a class="code" href="supportsSegmentationServer_8cpp.html#a4347491f1f8b99276368828ab1133658">minPlanePercentageSize</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    res.usedMaxVarianceThForHorizontal = <a class="code" href="supportsSegmentationServer_8cpp.html#af902851fe5d5f9b83a6fd3caa09ff6e6">maxVarianceThForHorizontal</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    res.usedMinVarianceThForHorizontal =  <a class="code" href="supportsSegmentationServer_8cpp.html#a197bb458bd6fcbde04f684821eec83fb">minVarianceThForHorizontal</a>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    res.usedRansaxMaxIterationTh = <a class="code" href="supportsSegmentationServer_8cpp.html#adf23ae5b5b90ea992496e126ae78a3a5">ransacMaxIteration</a>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    res.usedRansacThDistancePointShape = <a class="code" href="supportsSegmentationServer_8cpp.html#acb13e2ccfe978df3c0ae59f3209561e7">ransacThDistancePointShape</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    res.usedRansacModelDistanceWeigth = <a class="code" href="supportsSegmentationServer_8cpp.html#ad870cd7d7c56cf82343d1a2a59072627">ransacNormalDistanceWeigth</a>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    res.usedHorizontalAxis.push_back( <a class="code" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a>[ 0]);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    res.usedHorizontalAxis.push_back( <a class="code" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a>[ 1]);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    res.usedHorizontalAxis.push_back( <a class="code" href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a>[ 2]);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    res.usedSupportEdgeRemoveOfset = <a class="code" href="supportsSegmentationServer_8cpp.html#a99daf6bf3b99a58055b66c72a8040bef">supportEdgeRemoveOffset</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">// Initialize node</span></div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="supportsSegmentationServer_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">  360</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="supportsSegmentationServer_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv){</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    init(argc, argv, PCManager::SUPPORT_FILTER_SERVICE_NAME);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    NodeHandle n;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">//vis = PCManager::createVisor( &quot;Inlier idx w.r.t. originalCloud&quot;);</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    ServiceServer service = n.advertiseService( PCManager::SUPPORT_FILTER_SERVICE_NAME, <a class="code" href="supportsSegmentationServer_8cpp.html#a5516ae3363218ea9eafda7f65e6d2a49">findSupports</a>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    spin();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a4347491f1f8b99276368828ab1133658"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a4347491f1f8b99276368828ab1133658">minPlanePercentageSize</a></div><div class="ttdeci">float minPlanePercentageSize</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00043">supportsSegmentationServer.cpp:43</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a5516ae3363218ea9eafda7f65e6d2a49"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a5516ae3363218ea9eafda7f65e6d2a49">findSupports</a></div><div class="ttdeci">bool findSupports(SupportSegmentation::Request &amp;req, SupportSegmentation::Response &amp;res)</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00243">supportsSegmentationServer.cpp:243</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_aad09e65ed4fbd692157ce317f949c892"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#aad09e65ed4fbd692157ce317f949c892">minIterativeCloudPercentage</a></div><div class="ttdeci">float minIterativeCloudPercentage</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00043">supportsSegmentationServer.cpp:43</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a197bb458bd6fcbde04f684821eec83fb"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a197bb458bd6fcbde04f684821eec83fb">minVarianceThForHorizontal</a></div><div class="ttdeci">float minVarianceThForHorizontal</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00043">supportsSegmentationServer.cpp:43</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a7788e49ce18c43d68c6e9b31f7c8c1eb"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a7788e49ce18c43d68c6e9b31f7c8c1eb">getPointOnPlane</a></div><div class="ttdeci">PCLCloudPtr getPointOnPlane(PCLCloudPtr plane, PrimitiveIdxPtr inlierIdx, int mapLevel)</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00189">supportsSegmentationServer.cpp:189</a></div></div>
<div class="ttc" id="PCPrimitive_8h_html_a6ec0f6fbb026ae4b66cac121673c3a8a"><div class="ttname"><a href="PCPrimitive_8h.html#a6ec0f6fbb026ae4b66cac121673c3a8a">PrimitiveIdxPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; std::vector&lt; int &gt; &gt; PrimitiveIdxPtr</div><div class="ttdef"><b>Definition:</b> <a href="PCPrimitive_8h_source.html#l00019">PCPrimitive.h:19</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_aba5cf30daaf1f4bd0b577e2a1eaacc1f"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#aba5cf30daaf1f4bd0b577e2a1eaacc1f">horizontalAxis</a></div><div class="ttdeci">float horizontalAxis[3]</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00044">supportsSegmentationServer.cpp:44</a></div></div>
<div class="ttc" id="PCPrimitive_8h_html_aa14a240c8d999c4f56133c0f70e88783"><div class="ttname"><a href="PCPrimitive_8h.html#aa14a240c8d999c4f56133c0f70e88783">PCLCloudPtr</a></div><div class="ttdeci">pcl::PointCloud&lt; pcl::PointXYZ &gt;::Ptr PCLCloudPtr</div><div class="ttdef"><b>Definition:</b> <a href="PCPrimitive_8h_source.html#l00021">PCPrimitive.h:21</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a7e5e89000afcc1ee5b2f3aca14c819d8"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a7e5e89000afcc1ee5b2f3aca14c819d8">HORIZONTAL_AXIS</a></div><div class="ttdeci">static const float HORIZONTAL_AXIS[3]</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00039">supportsSegmentationServer.cpp:39</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a2974d140b39b60770786decb2d3565b1"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a2974d140b39b60770786decb2d3565b1">originalNorms</a></div><div class="ttdeci">PCLNormalPtr originalNorms</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00085">supportsSegmentationServer.cpp:85</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_ac8a873b38ae54d8231e11fc61c6abc54"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#ac8a873b38ae54d8231e11fc61c6abc54">originalCloud</a></div><div class="ttdeci">PCLCloudPtr originalCloud</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00084">supportsSegmentationServer.cpp:84</a></div></div>
<div class="ttc" id="PCManager_8h_html_a38c805dbc7ad6f06109b85c8e540817a"><div class="ttname"><a href="PCManager_8h.html#a38c805dbc7ad6f06109b85c8e540817a">PCLVisualizer</a></div><div class="ttdeci">boost::shared_ptr&lt; visualization::PCLVisualizer &gt; PCLVisualizer</div><div class="ttdef"><b>Definition:</b> <a href="PCManager_8h_source.html#l00023">PCManager.h:23</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_abb8f65165b6cd9a52d46c3f8dab2872f"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#abb8f65165b6cd9a52d46c3f8dab2872f">vis</a></div><div class="ttdeci">PCLVisualizer vis</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00083">supportsSegmentationServer.cpp:83</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_acc65cc4496947189ecf64074b20c9a6b"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#acc65cc4496947189ecf64074b20c9a6b">RANSAC_MAX_ITERATION_TH</a></div><div class="ttdeci">static const int RANSAC_MAX_ITERATION_TH</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00036">supportsSegmentationServer.cpp:36</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_acb13e2ccfe978df3c0ae59f3209561e7"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#acb13e2ccfe978df3c0ae59f3209561e7">ransacThDistancePointShape</a></div><div class="ttdeci">float ransacThDistancePointShape</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00043">supportsSegmentationServer.cpp:43</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_ad870cd7d7c56cf82343d1a2a59072627"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#ad870cd7d7c56cf82343d1a2a59072627">ransacNormalDistanceWeigth</a></div><div class="ttdeci">float ransacNormalDistanceWeigth</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00043">supportsSegmentationServer.cpp:43</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_aec3cb01834351aa77d85fb42364ff543"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#aec3cb01834351aa77d85fb42364ff543">removePlaneInliner</a></div><div class="ttdeci">void removePlaneInliner(PCLCloudPtr inputCloud, PointIndices::Ptr &amp;removeIndex, PCLCloudPtr output)</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00120">supportsSegmentationServer.cpp:120</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a93fe6461918fe6c40665c81167c39f43"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a93fe6461918fe6c40665c81167c39f43">ransacPlaneSegmentator</a></div><div class="ttdeci">void ransacPlaneSegmentator(PCLCloudPtr inputCloud, PCLNormalPtr normals, PointIndices::Ptr &amp;inlierOutput, ModelCoefficients::Ptr &amp;coefficientOutput)</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00095">supportsSegmentationServer.cpp:95</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a12c2040f25d8e3a7b9e1c2024c618cb6"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a12c2040f25d8e3a7b9e1c2024c618cb6">INF</a></div><div class="ttdeci">#define INF</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00188">supportsSegmentationServer.cpp:188</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_af902851fe5d5f9b83a6fd3caa09ff6e6"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#af902851fe5d5f9b83a6fd3caa09ff6e6">maxVarianceThForHorizontal</a></div><div class="ttdeci">float maxVarianceThForHorizontal</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00043">supportsSegmentationServer.cpp:43</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a7ea400b8bac873942021139dabfda6be"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a7ea400b8bac873942021139dabfda6be">SUPPORT_EDG_REMOVEE_OFSET</a></div><div class="ttdeci">static const float SUPPORT_EDG_REMOVEE_OFSET</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00040">supportsSegmentationServer.cpp:40</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a036699b594fc2e37ecd35243a0a7e2bb"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a036699b594fc2e37ecd35243a0a7e2bb">LESS_INF</a></div><div class="ttdeci">#define LESS_INF</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00187">supportsSegmentationServer.cpp:187</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_af8b66843d91c073a7339d97da05e4cfa"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#af8b66843d91c073a7339d97da05e4cfa">MIN_ITERATIVE_CLOUD_PERCENTUAL_SIZE</a></div><div class="ttdeci">static const float MIN_ITERATIVE_CLOUD_PERCENTUAL_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00033">supportsSegmentationServer.cpp:33</a></div></div>
<div class="ttc" id="PCPrimitive_8h_html_a1bc38ce8b0c26e5f2d28fae9f3e3ea97"><div class="ttname"><a href="PCPrimitive_8h.html#a1bc38ce8b0c26e5f2d28fae9f3e3ea97">PCLNormalPtr</a></div><div class="ttdeci">pcl::PointCloud&lt; pcl::Normal &gt;::Ptr PCLNormalPtr</div><div class="ttdef"><b>Definition:</b> <a href="PCPrimitive_8h_source.html#l00023">PCPrimitive.h:23</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_adf23ae5b5b90ea992496e126ae78a3a5"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#adf23ae5b5b90ea992496e126ae78a3a5">ransacMaxIteration</a></div><div class="ttdeci">int ransacMaxIteration</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00045">supportsSegmentationServer.cpp:45</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a99daf6bf3b99a58055b66c72a8040bef"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a99daf6bf3b99a58055b66c72a8040bef">supportEdgeRemoveOffset</a></div><div class="ttdeci">float supportEdgeRemoveOffset</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00043">supportsSegmentationServer.cpp:43</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_ab8a45d894e93cb97afbd56586a97172d"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#ab8a45d894e93cb97afbd56586a97172d">RANSAC_TH_DISTANCE_POINT_SHAPE</a></div><div class="ttdeci">static const float RANSAC_TH_DISTANCE_POINT_SHAPE</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00037">supportsSegmentationServer.cpp:37</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_af7452b4e42ac3352d3b9ff7c19dff6ea"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#af7452b4e42ac3352d3b9ff7c19dff6ea">valueBelongsToArray</a></div><div class="ttdeci">bool valueBelongsToArray(int value, PointIndices::Ptr inliers)</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00136">supportsSegmentationServer.cpp:136</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a32c40c5b97dadeee297fd5e4f8d36513"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a32c40c5b97dadeee297fd5e4f8d36513">createNewIdxMap</a></div><div class="ttdeci">PrimitiveIdxPtr createNewIdxMap(PrimitiveIdxPtr previousInliersMap, PointIndices::Ptr inliers, int level)</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00144">supportsSegmentationServer.cpp:144</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a1cb5f58d4341fb0ea8be5786e76e850c"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a1cb5f58d4341fb0ea8be5786e76e850c">MIN_PLANE_PERCENTAGE_SIZE</a></div><div class="ttdeci">static const float MIN_PLANE_PERCENTAGE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00034">supportsSegmentationServer.cpp:34</a></div></div>
<div class="ttc" id="PCPrimitive_8h_html_abe81b5e6ffcc0ceb1b95b0489419027d"><div class="ttname"><a href="PCPrimitive_8h.html#abe81b5e6ffcc0ceb1b95b0489419027d">PCLNormal</a></div><div class="ttdeci">pcl::PointCloud&lt; pcl::Normal &gt; PCLNormal</div><div class="ttdef"><b>Definition:</b> <a href="PCPrimitive_8h_source.html#l00022">PCPrimitive.h:22</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_ac380aeac6f81ac15dbab87458f1309f1"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#ac380aeac6f81ac15dbab87458f1309f1">seg</a></div><div class="ttdeci">SACSegmentationFromNormals&lt; PointXYZ, Normal &gt; seg</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00094">supportsSegmentationServer.cpp:94</a></div></div>
<div class="ttc" id="PCPrimitive_8h_html_a02a7c0cdfcd324f1b5b87ce549fdbe10"><div class="ttname"><a href="PCPrimitive_8h.html#a02a7c0cdfcd324f1b5b87ce549fdbe10">PCLCloud</a></div><div class="ttdeci">pcl::PointCloud&lt; pcl::PointXYZ &gt; PCLCloud</div><div class="ttdef"><b>Definition:</b> <a href="PCPrimitive_8h_source.html#l00020">PCPrimitive.h:20</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_ad788fb6fb1f61d45a10993e909fddad8"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#ad788fb6fb1f61d45a10993e909fddad8">extract</a></div><div class="ttdeci">ExtractIndices&lt; PointXYZ &gt; extract(true)</div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a53687def603ff613a673c0dd550acf4e"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a53687def603ff613a673c0dd550acf4e">initializeParameters</a></div><div class="ttdeci">void initializeParameters(SupportSegmentation::Request &amp;req)</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00046">supportsSegmentationServer.cpp:46</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a31976c93f57ecffe05dcdb46e5a1eb4a"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a31976c93f57ecffe05dcdb46e5a1eb4a">MAX_VARIANCE_TH_FOR_HORIZONTAL</a></div><div class="ttdeci">static const float MAX_VARIANCE_TH_FOR_HORIZONTAL</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00035">supportsSegmentationServer.cpp:35</a></div></div>
<div class="ttc" id="PCPrimitive_8h_html_a9aba110b238bb80390c2545da40823e3"><div class="ttname"><a href="PCPrimitive_8h.html#a9aba110b238bb80390c2545da40823e3">PrimitiveIdx</a></div><div class="ttdeci">std::vector&lt; int &gt; PrimitiveIdx</div><div class="ttdef"><b>Definition:</b> <a href="PCPrimitive_8h_source.html#l00018">PCPrimitive.h:18</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_ab0fa44eb10c2965d2e3a67a7f386c747"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#ab0fa44eb10c2965d2e3a67a7f386c747">isHorizontalPlane</a></div><div class="ttdeci">bool isHorizontalPlane(PCLNormalPtr normal, ModelCoefficients::Ptr coefficients, const float referimentAxis[3])</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00166">supportsSegmentationServer.cpp:166</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a9dc99e81f4ba41b83214b0d6b629dd10"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a9dc99e81f4ba41b83214b0d6b629dd10">RANSAC_NORMAL_DISTANCE_WEIGHT</a></div><div class="ttdeci">static const float RANSAC_NORMAL_DISTANCE_WEIGHT</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00038">supportsSegmentationServer.cpp:38</a></div></div>
<div class="ttc" id="supportsSegmentationServer_8cpp_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="supportsSegmentationServer_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="supportsSegmentationServer_8cpp_source.html#l00360">supportsSegmentationServer.cpp:360</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_f720b26f6b9e98dbcb1290ba1630b5b3.html">SegmentationServices</a></li><li class="navelem"><a class="el" href="supportsSegmentationServer_8cpp.html">supportsSegmentationServer.cpp</a></li>
    <li class="footer">Generated on Thu Mar 3 2016 19:00:06 for Primitive Identification Tagging &amp; Tracking (PITT). The  &quot;Object Table Segmentation&quot; package by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
